<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>越南語學習小站 v4.1（單檔急救版）</title>
<style>
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans CJK TC",sans-serif;margin:0;background:#fff4f7;color:#222}
header{background:#ff6680;color:#fff;padding:16px;text-align:center}
section{max-width:1000px;margin:0 auto;padding:16px}
h2{color:#ff6680}
.card{display:inline-block;margin:6px;padding:8px 10px;background:#fff;border:1px solid #ffd2dc;border-radius:10px;cursor:pointer}
.row{display:flex;gap:6px;flex-wrap:wrap;align-items:center}
.box{background:#fff;border:1px solid #ffd2dc;border-radius:12px;padding:12px;margin:10px 0}
.btn{background:#ff6680;border:0;color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer}
.btn.ghost{background:#fff;color:#ff6680;border:2px solid #ff6680}
.small{font-size:12px;color:#666}
.dialogue{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:center;border-bottom:1px dashed #ffd2dc;padding:8px 0}
</style>
</head>
<body>
<header><h1>越南語學習小站 v4.1（單檔急救版）</h1><div class="small">若這版能正常顯示，代表你的 GitHub Pages 部署路徑沒問題。</div></header>

<section class="box">
  <h2>語音測試</h2>
  <div class="row">
    <button class="btn" onclick="testVN()">▶ 測試：Xin chào</button>
    <div id="voiceInfo" class="small"></div>
  </div>
</section>

<section class="box">
  <h2>字母表</h2>
  <div id="alphabet" class="row"></div>
</section>

<section class="box">
  <h2>聲調</h2>
  <div id="tones" class="row"></div>
</section>

<section class="box">
  <h2>數字＋量詞</h2>
  <div id="numbers"></div>
</section>

<section class="box">
  <h2>數字 1–100</h2>
  <div id="num100"></div>
</section>

<section class="box">
  <h2>主題對話</h2>
  <div id="dialogues"></div>
</section>

<section class="box">
  <h2>隨機測驗遊戲</h2>
  <button class="btn" onclick="startQuiz()">開始測驗</button>
  <div id="quiz" style="margin-top:8px;"></div>
</section>

<section class="box">
  <h2>模擬鑑定測驗（50 題）</h2>
  <button class="btn" onclick="startExam()">開始模擬</button>
  <div id="exam" style="margin-top:8px;"></div>
</section>

<script>
const ALPHABET=[
 {"char":"A","say":"a"},{"char":"Ă","say":"ă"},{"char":"Â","say":"â"},{"char":"B","say":"bê"},{"char":"C","say":"xê"},
 {"char":"D","say":"dê"},{"char":"Đ","say":"đê"},{"char":"E","say":"e"},{"char":"Ê","say":"ê"},{"char":"G","say":"gờ"},
 {"char":"H","say":"hát"},{"char":"I","say":"i"},{"char":"K","say":"ca"},{"char":"L","say":"e-lờ"},{"char":"M","say":"em"},
 {"char":"N","say":"en"},{"char":"O","say":"o"},{"char":"Ô","say":"ô"},{"char":"Ơ","say":"ơ"},{"char":"P","say":"pê"},
 {"char":"Q","say":"quy"},{"char":"R","say":"er"},{"char":"S","say":"ét"},{"char":"T","say":"tê"},{"char":"U","say":"u"},
 {"char":"Ư","say":"ư"},{"char":"V","say":"vê"},{"char":"X","say":"ích"},{"char":"Y","say":"i dài"}
];
const TONES=[{"mark":"ma","desc":"ngang"},{"mark":"má","desc":"sắc"},{"mark":"mà","desc":"huyền"},
             {"mark":"mả","desc":"hỏi"},{"mark":"mã","desc":"ngã"},{"mark":"mạ","desc":"nặng"}];
const NUMS={1:"một",2:"hai",3:"ba",4:"bốn",5:"năm",6:"sáu",7:"bảy",8:"tám",9:"chín",10:"mười"};
const COUNTERS=[
 {"counter":"cái","note":"一般物品（衣服、杯子）"},
 {"counter":"con","note":"動物（狗、貓、魚）"},
 {"counter":"chiếc","note":"件/台（車、機器、衣服）"},
 {"counter":"tấm","note":"張（桌子、紙張）"},
 {"counter":"quyển","note":"本（書、雜誌）"}
];
const DIALOGS=[
 {"tag":"衣服購物","vi":["Tôi có thể thử áo này không?","Vâng, phòng thử đồ ở đằng kia.","Xin lỗi, hàng giảm giá thì không được thử."],
  "zh":["這件衣服可以試穿嗎？","可以，試衣間在那邊。","抱歉，特價品不能試穿。"]},
 {"tag":"餐廳","vi":["Có món nào đặc biệt không?","Hôm nay có phở bò.","Gỏi cuốn rất ngon."],
  "zh":["有推薦的菜嗎？","今天有牛肉河粉。","生春捲很好吃。"]},
 {"tag":"交通","vi":["Xe buýt này đi đâu?","Đi đến trung tâm thành phố.","Dừng ở bến cuối là chợ Bến Thành."],
  "zh":["這班公車去哪裡？","去市中心。","停在濱城市場。"]}
];

// Numbers 1–100
const VN100=(function(){
  const nums=NUMS;
  function w(n){
    if(n<=10) return nums[n];
    if(n<20){ if(n===15) return "mười lăm"; return "mười "+nums[n-10]; }
    const tens=Math.floor(n/10), ones=n%10;
    const tensw = tens>1 ? nums[tens]+" mươi" : "mười";
    if(ones===0) return tensw;
    if(ones===1) return tens>1 ? tensw+" mốt" : tensw+" một";
    if(ones===5) return tensw+" lăm";
    return tensw+" "+nums[ones];
  }
  const map={}; for(let i=1;i<=100;i++) map[i]=w(i); return map;
})();

function getVNVoice(){const v=speechSynthesis.getVoices();return v.find(x=>x.lang && x.lang.toLowerCase().startsWith('vi'));}
function speak(t,f){const v=getVNVoice();const u=new SpeechSynthesisUtterance(t);if(v)u.voice=v;else{u.lang='en-US';u.text=f||t;}speechSynthesis.speak(u);}
function testVN(){ const v=getVNVoice(); const info=document.getElementById('voiceInfo'); if(v){info.textContent="偵測到越南語語音："+v.name+" ("+v.lang+")";} else {info.textContent="未偵測到越南語語音，使用英語 fallback。建議到系統下載越南語 voice。"}; speak("Xin chào","Xin chao"); }

// Render alphabet
const ab=document.getElementById('alphabet');
ALPHABET.forEach(o=>{const b=document.createElement('button');b.className='card';b.textContent=o.char; b.onclick=()=>speak(o.char,o.say); ab.appendChild(b);});

// Render tones
const tn=document.getElementById('tones');
TONES.forEach(o=>{const b=document.createElement('button');b.className='card';b.textContent=o.mark+" ("+o.desc+")"; b.onclick=()=>speak(o.mark,o.mark); tn.appendChild(b);});

// Numbers + classifiers
const nm=document.getElementById('numbers');
for(let i=1;i<=10;i++){const d=document.createElement('div');d.className='card';d.textContent=i+": "+NUMS[i];d.onclick=()=>speak(NUMS[i],NUMS[i]);nm.appendChild(d);}
COUNTERS.forEach(c=>{const d=document.createElement('div');d.className='card';d.textContent=c.counter+" — "+c.note;nm.appendChild(d);});

// Numbers 1-100
const n100=document.getElementById('num100');
for(let i=1;i<=100;i++){const d=document.createElement('div');d.className='card';d.textContent=i+": "+VN100[i];d.onclick=()=>speak(VN100[i],VN100[i]);n100.appendChild(d);}

// Dialogues
const dl=document.getElementById('dialogues');
DIALOGS.forEach(d=>{
  const box=document.createElement('div'); box.className='box'; box.innerHTML="<b>"+d.tag+"</b>";
  d.vi.forEach((line,i)=>{
    const row=document.createElement('div'); row.className='dialogue';
    const left=document.createElement('div'); left.innerHTML='<div>'+(i===0?'❓ ':'🗣️ ')+line+'</div><div class="small">— '+(d.zh[i]||'')+'</div>';
    const right=document.createElement('div'); const sp=document.createElement('button'); sp.className='btn'; sp.textContent='▶ 朗讀'; sp.onclick=()=>speak(line,line);
    right.appendChild(sp); row.appendChild(left); row.appendChild(right); box.appendChild(row);
  });
  dl.appendChild(box);
});

// Simple random quiz (10 questions)
let quizData=[],score=0,total=0;
function startQuiz(){
  quizData=[]; DIALOGS.forEach(d=>d.vi.forEach((l,i)=>quizData.push({vi:l,zh:d.zh[i]||''})));
  quizData=quizData.sort(()=>Math.random()-0.5).slice(0,10); score=0; total=0; renderQuiz();
}
function renderQuiz(){
  const qd=document.getElementById('quiz');
  if(total>=quizData.length){ qd.innerHTML="完成！得分："+score+"/"+quizData.length; return; }
  const q=quizData[total]; const allZh=[].concat(...DIALOGS.map(d=>d.zh));
  const opts=new Set([q.zh]); while(opts.size<4) opts.add(allZh[Math.floor(Math.random()*allZh.length)]||"（空）");
  const list=[...opts].sort(()=>Math.random()-0.5);
  qd.innerHTML="<div>🗣️ "+q.vi+"</div>";
  list.forEach(opt=>{ const b=document.createElement('button'); b.className='btn ghost'; b.textContent=opt; b.onclick=()=>{ if(opt===q.zh)score++; total++; renderQuiz(); }; qd.appendChild(b); });
}

// Simulated exam (50 questions)
const EXAM=(function(){ const arr=[]; const baseOpts=["你好","再見","謝謝","多少錢"]; for(let i=1;i<=50;i++){ const opts=baseOpts.slice().sort(()=>Math.random()-0.5); arr.push({q:`題目 ${i}: 'xin chào' 的正確中文意思是？`, ans:"你好", opts}); } return arr; })();
let examIdx=0, examScore=0;
function startExam(){ examIdx=0; examScore=0; renderExam(); }
function renderExam(){
  const div=document.getElementById('exam');
  if(examIdx>=EXAM.length){ div.innerHTML="模擬完成！得分："+examScore+"/"+EXAM.length; return; }
  const q=EXAM[examIdx]; div.innerHTML=`<div><b>${q.q}</b></div>`;
  q.opts.forEach(opt=>{ const b=document.createElement('button'); b.className='btn ghost'; b.textContent=opt; b.onclick=()=>{ if(opt===q.ans) examScore++; examIdx++; renderExam(); }; div.appendChild(b); });
}
</script>
</body>
</html>
